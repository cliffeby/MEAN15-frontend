<div class="match-list">
  <h2>Matches</h2>
  
  <!-- Action buttons -->
  <div class="action-bar">
    <button *ngIf="isAuthorized" mat-raised-button color="primary" (click)="addMatch()">Add Match</button>
    <button mat-button (click)="refreshMatches()">Refresh</button>
    <button mat-button (click)="loadAllMatches()">All</button>
    <button mat-button (click)="loadMatchesByStatus('open')">Open</button>
    <button mat-button (click)="loadMatchesByStatus('completed')">Completed</button>
  </div>

  <!-- Stats (optional) -->
  <div class="stats" *ngIf="stats$ | async as stats">
    <mat-chip-set>
      <mat-chip>Total: {{ stats.total }}</mat-chip>
      <mat-chip color="primary" selected>Open: {{ stats.open }}</mat-chip>
      <mat-chip color="accent" selected>Completed: {{ stats.completed }}</mat-chip>
    </mat-chip-set>
  </div>

  <mat-divider></mat-divider>

  <!-- Loading indicator -->
  <mat-progress-bar *ngIf="loading$ | async" mode="indeterminate"></mat-progress-bar>

  <!-- Error display -->
  <div *ngIf="error$ | async as error" class="error-message">
    <mat-chip color="warn" selected>Error: {{ error.message || 'Something went wrong' }}</mat-chip>
  </div>

  <!-- Matches list (paginated to configured page size) -->
  <mat-list *ngIf="paginatedMatches$ | async as matches">
    <div *ngIf="(totalMatches$ | async) === 0 && !(loading$ | async)" class="no-matches">
      No matches found.
    </div>
    <mat-list-item *ngFor="let match of matches">
      <h3 mat-line class="match-title">{{ match.name }}</h3>
      <p mat-line>
        <span *ngIf="match.scGroupName">Course: {{ match.scGroupName }}</span>
        <span *ngIf="getPlayerCount(match) > 0"> | {{ getPlayerCount(match) }} Players</span>
      </p>
      <p mat-line class="status-line">
        <mat-chip [color]="getStatusColor(match.status)" selected>
          {{ match.status | titlecase }}
        </mat-chip>
        <mat-chip *ngIf="!match.scorecardId" color="warn" selected>
          <mat-icon>warning</mat-icon>
          No Scorecard
        </mat-chip>
        <span class="date-on-right">{{ formatDate(match.datePlayed || match.createdAt) }}</span>
      </p>
      <span class="spacer"></span>
      <div class="button-group" matListItemMeta>
        <button *ngIf="match.scorecardId" mat-button color="accent" (click)="printScorecard((match._id) || '')">
          <mat-icon>print</mat-icon>
          Print Scorecard
        </button>
        <button *ngIf="isAuthorized && match.scorecardId" mat-button color="primary" (click)="enterScores((match._id) || '')">
          <mat-icon>scorecard</mat-icon>
          Enter Scores
        </button>
        <button *ngIf="isAuthorized" mat-button color="accent" (click)="editMatch(( match._id) || '')">Edit</button>
        <button mat-button color="primary" (click)="updateStatus((match._id) || '', 'completed')" 
          *ngIf="isAuthorized && match.status !== 'completed'">Complete</button>
        <button *ngIf="isAuthorized" mat-button color="warn" (click)="deleteMatch((match._id) || '')">Delete</button>
      </div>
    </mat-list-item>
  </mat-list>

  <!-- Paginator: controls visible page size and page index -->
  <mat-paginator
    [length]="totalMatches$ | async"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="showPageSizeOptions ? pageSizeOptions : [pageSize]"
    [showFirstLastButtons]="showFirstLastButtons"
    (page)="onPageChange($event)">
  </mat-paginator>
</div>