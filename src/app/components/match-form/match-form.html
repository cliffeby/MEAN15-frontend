<form [formGroup]="matchForm" (ngSubmit)="submit()" class="match-form">
  <h2>Create New Match</h2>

  <mat-form-field appearance="fill">
    <mat-label>Match Name</mat-label>
    <input matInput formControlName="name" required placeholder="Enter match name" title="Match Name" />
    <mat-error *ngIf="matchForm.get('name')?.hasError('required')">
      Match name is required
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Course/Group Name</mat-label>
    <mat-select formControlName="scorecardId" placeholder="Select a scorecard" (selectionChange)="onScorecardChange($event.value)">
      <mat-option value="">None</mat-option>
      <mat-option *ngFor="let scorecard of scorecards" [value]="scorecard._id">
        {{ scorecard.course || 'Unnamed Scorecard' }}
        <!-- <span *ngIf="scorecard.rating"> - Rating: {{ scorecard.rating }}</span>
        <span *ngIf="scorecard.slope"> - Slope: {{ scorecard.slope }}</span> -->
      </mat-option>
    </mat-select>
    <mat-error *ngIf="matchForm.get('scorecardId')?.hasError('required')">
      Selection is required
    </mat-error>
  </mat-form-field>
<!-- 
  <mat-form-field appearance="fill">
    <mat-label>Course/Group Name</mat-label>
    <input matInput formControlName="scGroupName" placeholder="Enter course or group name" title="Course Name" />
  </mat-form-field> -->

  <mat-form-field appearance="fill">
    <mat-label>Status</mat-label>
    <mat-select formControlName="status" required>
      <mat-option *ngFor="let status of statusOptions" [value]="status.value">
        {{ status.label }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="matchForm.get('status')?.hasError('required')">
      Status is required
    </mat-error>
  </mat-form-field>

  <!-- Member Lineup Section -->
  <div class="lineup-section">
    <app-match-lineup
      [members]="(members$ | async) ?? []"
      [lineUpsArray]="lineUpsArray"
      (removeGroup)="onRemoveGroup($event)"
      (addMembers)="onAddMembers()">
    </app-match-lineup>
  </div>

  <mat-form-field appearance="fill">
    <mat-label>Date Played</mat-label>
    <input matInput [matDatepicker]="picker" formControlName="datePlayed" placeholder="Select date played" title="Date Played" />
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
    <mat-error *ngIf="matchForm.get('datePlayed')?.hasError('required')">
      Date played is required
    </mat-error>
  </mat-form-field>

  <!-- User field is hidden and automatically set to current user -->

  <button mat-raised-button color="primary" type="submit" [disabled]="(loading$ | async) || matchForm.invalid">
    {{ (loading$ | async) ? 'Creating...' : 'Create Match' }}
  </button>
</form>